# 微信开发者工具设置说明

## 解决图片加载失败问题

### 问题描述
小程序图片加载失败，显示"图片加载失败"错误，API接口正常但图片无法显示。

### 解决方案

#### 1. 微信开发者工具设置

**重要：必须按照以下步骤设置，否则图片无法加载**

1. **打开微信开发者工具**
2. **点击右上角"详情"按钮**
3. **在"本地设置"选项卡中，确保以下选项已勾选：**
   - ✅ **不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书**
   - ✅ **不校验安全域名、TLS 版本以及 HTTPS 证书**
   - ✅ **开启调试模式**

#### 2. 项目设置

1. **点击工具栏的"设置"图标**
2. **选择"项目设置"**
3. **在"本地设置"中确保：**
   - ✅ **不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书**

#### 3. 网络设置

1. **确保后端服务器正常运行**
   ```bash
   cd mini-server
   ./start-dev.sh
   ```

2. **测试API接口是否正常**
   ```bash
   curl "http://127.0.0.1:3002/health"
   ```

3. **测试图片接口是否正常**
   ```bash
   curl "http://127.0.0.1:3002/uploads/test.jpg"
   ```

#### 4. 常见问题排查

**问题1：图片仍然加载失败**
- 检查微信开发者工具设置是否正确
- 确认后端服务器是否正常运行
- 检查网络连接是否正常

**问题2：API接口正常但图片无法显示**
- 这是微信小程序的安全限制
- 必须开启"不校验合法域名"设置
- 确保在开发环境中测试

**问题3：生产环境图片加载问题**
- 生产环境必须使用HTTPS协议
- 需要配置有效的SSL证书
- 图片域名需要在小程序后台配置

#### 5. 开发环境配置

```javascript
// 确保开发环境使用HTTP
const config = {
  develop: {
    baseUrl: 'http://127.0.0.1:3002',
    imageBaseUrl: 'http://127.0.0.1:3002',
    enableSSL: false
  }
};
```

#### 6. 测试步骤

1. **重启微信开发者工具**
2. **重新编译小程序**
3. **检查控制台是否有错误信息**
4. **测试图片加载是否正常**

### 注意事项

1. **开发环境必须使用HTTP协议**
2. **必须开启微信开发者工具的相关设置**
3. **生产环境必须使用HTTPS协议**
4. **图片资源建议使用CDN加速**

### 如果问题仍然存在

1. **清理微信开发者工具缓存**
2. **重新导入项目**
3. **检查防火墙设置**
4. **确认端口3002没有被其他程序占用** 