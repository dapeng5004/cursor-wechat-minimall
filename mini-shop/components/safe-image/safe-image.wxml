<!--components/safe-image/safe-image.wxml-->
<view class="safe-image-container">
  <!-- 骨架屏渐变动画 -->
  <view wx:if="{{isLoading}}" class="skeleton"></view>

  <!-- 加载状态 -->
  <view wx:if="{{isLoading}}" class="image-loading">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
  
  <!-- 图片 -->
  <image 
    wx:if="{{imageSrc}}"
    src="{{imageSrc}}"
    mode="{{mode}}"
    lazy-load="{{lazyLoad}}"
    show-menu-by-longpress="{{showMenuByLongpress}}"
    class="safe-image {{hasError ? 'image-error' : ''}}"
    bindload="onImageLoad"
    binderror="onImageError"
    bindtap="onImageTap"
    style="opacity:{{isLoading?0:1}};"
  />
  
  <!-- 错误状态 -->
  <view wx:if="{{hasError && !isLoading}}" class="image-error-placeholder">
    <image 
      src="{{defaultSrc}}"
      mode="{{mode}}"
      class="default-image"
    />
    <text class="error-text">图片加载失败</text>
  </view>
</view> 