<!--pages/category-goods/category-goods.wxml-->
<view class="container">
  <!-- 分类商品列表 -->
  <view class="category-goods-section">
    <view class="goods-grid">
      <view class="goods-item-wrapper" wx:for="{{goodsList}}" wx:key="id">
        <goods-item 
          goods="{{item}}"
          show-add-cart="{{true}}"
          show-stock="{{true}}"
          size="normal"
          bind:addcartsuccess="onAddCartSuccess"
          bind:itemtap="onGoodsItemTap"
        />
      </view>
    </view>
  </view>

  <!-- 加载更多 -->
  <view class="load-more" wx:if="{{loading && hasMore}}">
    <loading 
      show="{{loading}}" 
      type="circle" 
      text="加载中..." 
      style="inline"
      mask="{{false}}"
    />
  </view>

  <!-- 没有更多了 -->
  <view class="no-more" wx:if="{{!loading && !hasMore && goodsList.length > 0}}">
    <text class="no-more-text">没有更多了</text>
  </view>

  <!-- 分页错误重试 -->
  <view class="pagination-error" wx:if="{{paginationError}}">
    <view class="error-icon">⚠️</view>
    <view class="error-text">加载失败</view>
    <button class="retry-btn" bindtap="onRetryPagination">重新加载</button>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!globalLoading && !hasError && isEmpty}}">
    <view class="empty-icon">📦</view>
    <view class="empty-text">暂无商品</view>
  </view>

  <!-- 错误状态 -->
  <view class="error-state" wx:if="{{!globalLoading && hasError}}">
    <view class="error-icon">⚠️</view>
    <view class="error-text">加载失败</view>
    <button class="error-btn" bindtap="onRetry">重新加载</button>
  </view>

  <!-- 全局加载组件 -->
  <loading 
    show="{{globalLoading}}" 
    type="spinner" 
    text="加载中..." 
    mask="{{true}}"
  />
</view>